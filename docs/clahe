https://github.com/scikit-image/scikit-image/blob/master/skimage/exposure/_adapthist.py